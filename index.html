<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JennyOnly</title>
    <link rel="apple-touch-icon" href="image/icon.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #0d1b2a; /* æ·±é‚ƒæ˜Ÿç©ºè— */
            color: #e0e1dd;
        }
        #landing-page {
            display: none; /* Initially hidden */
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        #surprise-container {
            display: none; /* Initially hidden */
        }
        #password-gate {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #0d1b2a;
            transition: opacity 0.5s ease-out;
        }
        .day-card {
            background-color: #1b263b; /* è¼ƒæ·ºçš„è—ç°è‰² */
            border-radius: 8px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .day-card.unlocked:hover {
            transform: translateY(-5px) scale(1.05);
            background-color: #e0b1cb; /* æŸ”å’Œçš„ç²‰é‡‘è‰² */
            color: #0d1b2a;
            cursor: pointer;
        }
        .day-card.locked {
            background-color: #415a77; /* æ›´æ·ºçš„è—ç°è‰² */
            cursor: not-allowed;
        }
        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.7); }
        .modal-content { background-color: #1b263b; margin: 5% auto; padding: 2rem; border: 1px solid #778da9; width: 90%; max-width: 800px; border-radius: 10px; position: relative; }
        .modal .close-button { color: #aaa; position: absolute; top: 1rem; right: 1.5rem; font-size: 28px; font-weight: bold; cursor: pointer; }
        .modal .close-button:hover, .modal .close-button:focus { color: white; }

        #birthday-title, #personal-message, #monday-title, #monday-content {
            transition: opacity 1.5s ease-in-out;
        }
        #fireworks-canvas {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 51;
        }
        #birthday-title, #personal-message, #monday-title, #monday-content-wrapper {
            position: absolute;
            z-index: 52;
            text-align: center;
            pointer-events: none;
        }
        .accent-color { color: #e0e1dd; } /* æœˆå…‰éŠ€/æ˜Ÿå¡µç™½ */
        .accent-bg { background-color: #415a77; } /* è—ç°è‰² */
        .hover-accent-bg:hover { background-color: #778da9; }
        
        /* Game Styles */
        #spot-the-diff-container { position: relative; display: inline-block; }
        .diff-circle { position: absolute; /* border: 2px solid red; */ border-radius: 50%; cursor: pointer; box-sizing: border-box; }
        .diff-circle.found { background-color: rgba(0, 255, 0, 0.4); border: 2px solid limegreen; }

        /* Gift Reveal Styles */
        #gift-reveal-container {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            z-index: 200;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        #gift-box {
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        #gift-box:hover {
            transform: scale(1.1);
        }
        #gift-box.open {
            animation: glow 1.5s ease-in-out forwards;
        }
        @keyframes glow {
            0% { transform: scale(1.1); filter: drop-shadow(0 0 5px #fff); opacity: 1; }
            50% { transform: scale(1.2); filter: drop-shadow(0 0 25px #fff) drop-shadow(0 0 50px #e0b1cb); opacity: 1; }
            100% { transform: scale(0); filter: drop-shadow(0 0 5px #fff); opacity: 0; }
        }
        #gift-result {
            opacity: 0;
            transition: opacity 1s ease-in 1s;
        }
        #gift-result.visible {
            opacity: 1;
        }
        
        /* Coin Flip Styles */
        .coin-container {
            perspective: 1000px;
            height: 120px; /* Give it a height to contain the toss */
        }
        .coin-container.is-tossing {
            animation: toss-up-down 1.5s cubic-bezier(0.5, 0, 0.5, 1);
        }
        @keyframes toss-up-down {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-80px); }
        }
        .coin {
            width: 120px;
            height: 120px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 1.5s cubic-bezier(0.4, 0.0, 0.2, 1);
        }
        .face {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            backface-visibility: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            font-weight: bold;
            text-align: center;
            padding: 0.5rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2), inset 0 0 10px rgba(0,0,0,0.1);
        }
        .heads { /* çœ‹å¤œæ™¯ */
            background: linear-gradient(45deg, #fde047, #facc15);
            color: #422006;
        }
        .tails { /* çœ‹é›»å½± */
            background: linear-gradient(45deg, #e5e7eb, #d1d5db);
            color: #1f2937;
            transform: rotateX(180deg);
        }

        /* Fortune Cookie Style */
        #fortune-cookie.cracking {
            animation: crack 0.8s ease-in-out forwards;
        }
        @keyframes crack {
            0% { transform: scale(1); opacity: 1; }
            20% { transform: translateX(-5px) rotate(-5deg); }
            40% { transform: translateX(5px) rotate(5deg); }
            60% { transform: translateX(-5px) rotate(-5deg); }
            80% { transform: translateX(5px) rotate(5deg); }
            100% { transform: scale(1.5); opacity: 0; }
        }
        
        /* Scratch Card styles */
        #scratch-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            height: 100px;
            margin: auto;
            border-radius: 8px;
            overflow: hidden;
        }
        #scratch-prize {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #415a77;
            color: #e0e1dd;
        }
        #scratch-card {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            cursor: crosshair;
            z-index: 1;
        }
        #puzzle-container {
            width: 302px; /* æ‹¼åœ–å¡Šå¯¬åº¦ 100px * 3 + é‚Šæ¡† 2px */
            height: 401px; /* æ‹¼åœ–å¡Šé«˜åº¦ 133px * 3 + é‚Šæ¡† 2px */
            margin: auto;
            border: 1px solid #778da9;
        }
        .puzzle-piece {
            width: 100px;  /* å¯¬åº¦æ”¹ç‚º 100px */
            height: 133px; /* é«˜åº¦æ”¹ç‚º 133px */
            border: 1px solid #fff;
            cursor: pointer;
            float: left; /* æ–°å¢é€™è¡Œè®“æ‹¼åœ–å¡Šä¸¦æ’ */
            background-size: 300px 399px; /* èƒŒæ™¯åœ–ç¸½å°ºå¯¸ */
        }
        .puzzle-piece.selected {
            border: 2px solid #e0b1cb;
            opacity: 0.7;
        }
        /* --- Day 20 Quiz Styles --- */
        .quiz-option {
            display: block;
            width: 100%;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            border: 2px solid transparent;
            border-radius: 8px;
            background-color: #415a77;
            transition: all 0.2s ease-in-out;
        }
        .quiz-option:hover {
            background-color: #778da9;
            border-color: #e0b1cb;
        }
        .quiz-option.correct {
            background-color: #5d9b6a; /* Green for correct */
            color: white;
        }
        .quiz-option.incorrect {
            background-color: #b56576; /* Red for incorrect */
            color: white;
        }
        .quiz-option:disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }

        /* --- Day 25 Flash Effect --- */
        .flash-image-container {
            position: relative;
            width: 100%;
            height: 20rem; /* æ‚¨å¯ä»¥èª¿æ•´é€™å€‹é«˜åº¦ */
            background-color: #000;
            border-radius: 8px;
            overflow: hidden;
        }
        .flash-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: contain; /* ç¢ºä¿åœ–ç‰‡å®Œæ•´é¡¯ç¤ºä¸è®Šå½¢ */
            opacity: 0;
            transition: opacity 0.5s ease-in-out; /* æ·¡å…¥æ·¡å‡ºå‹•ç•« */
        }
        .flash-image.visible {
            opacity: 1;
        }
    </style>
</head>
<body>
    
    <div id="password-gate">
        <div class="w-full max-w-xs p-8 bg-gray-800 rounded-lg shadow-lg">
            <h2 class="text-2xl font-bold text-center accent-color mb-6">è«‹è¼¸å…¥å¯†ç¢¼</h2>
            <input type="password" id="password-input" class="w-full p-3 bg-gray-700 rounded text-white text-center text-lg tracking-widest">
            <button id="password-submit" class="w-full accent-bg hover-accent-bg text-white font-bold py-3 px-4 rounded mt-4">é€²å…¥</button>
            <p id="password-error" class="text-red-400 text-center mt-4 h-4"></p>
        </div>
    </div>


    <div id="landing-page">
        <h1 class="text-4xl md:text-7xl font-bold text-white mb-6 text-center animate-pulse">çµ¦æˆ‘çš„æœ€æ„›</h1>
        <p class="text-xl md:text-2xl text-gray-300 mb-12 text-center">ä¹æœˆçš„æ¯ä¸€å¤©ï¼Œéƒ½ç‚ºä½ æº–å‚™äº†ä¸€å€‹å°ç§˜å¯†</p>
        <button id="start-button" class="accent-bg hover-accent-bg text-white font-bold py-4 px-8 rounded-full text-xl transition duration-300 transform hover:scale-110">
            æ¥æ”¶ä»Šå¤©çš„å°é©šå–œ <i class="fas fa-gift ml-2"></i>
        </button>
    </div>

    <div id="surprise-container" class="hidden p-4 md:p-8">
        <h2 class="text-3xl md:text-5xl font-bold accent-color mb-8 text-center">ä¹æœˆé©šå–œæ—¥æ›†</h2>
        <div id="calendar-grid" class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-4 max-w-6xl mx-auto"></div>
    </div>

    <div id="surprise-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">Ã—</span>
            <div id="modal-body"></div>
        </div>
    </div>

    <div id="fireworks-container" class="hidden fixed top-0 left:0 w-full h-full bg-black z-50 flex justify-center items-center cursor-pointer">
        <canvas id="fireworks-canvas"></canvas>
        <div id="birthday-title" class="px-4">
            <h1 class="text-white text-4xl md:text-6xl font-bold" style="text-shadow: 0 0 20px #e0e1dd;">ç”Ÿæ—¥å¿«æ¨‚ï¼</h1>
        </div>
        <div id="personal-message" class="px-4 opacity-0">
            <h2 class="text-3xl md:text-4xl font-bold mb-4 accent-color">çµ¦å…¨ä¸–ç•Œæœ€æ£’çš„ä½ ï¼š</h2>
            <p class="text-gray-300 text-lg md:text-xl max-w-2xl mx-auto">
                è¬è¬ä½ å‡ºç¾åœ¨æˆ‘çš„ç”Ÿå‘½è£¡ï¼Œåƒä¸€é“å…‰ï¼Œé»äº®äº†æˆ‘æ‰€æœ‰çš„æ—¥å­ã€‚
                é¡˜ä½ æ°¸é éƒ½èƒ½åƒä»Šå¤©ä¸€æ¨£ï¼Œè¢«æ„›èˆ‡å¿«æ¨‚åŒ…åœã€‚
                æœªä¾†çš„æ¯ä¸€å¤©ï¼Œéƒ½æƒ³å’Œä½ ä¸€èµ·éã€‚
            </p>
        </div>
    </div>
    
    <div id="monday-motivation-container" class="hidden fixed top-0 left:0 w-full h-full bg-black z-50 flex justify-center items-center cursor-pointer">
        <span class="close-button absolute top-8 right-8 text-2xl">Ã—</span>
        <div id="monday-title" class="px-4">
            <h1 class="text-white text-4xl md:text-6xl font-bold" style="text-shadow: 0 0 20px #a0c4ff;"></h1>
        </div>
        <div id="monday-content-wrapper" class="px-4 opacity-0 w-full max-w-3xl">
            </div>
    </div>
    
    <div id="gift-reveal-container">
         <span class="close-button absolute top-8 right-8 text-2xl">Ã—</span>
         <div id="gift-box">
             <img src="" alt="ç¦®ç‰©ç®±" class="w-48 h-48">
             <p class="text-center mt-4 text-lg animate-pulse">é»æˆ‘æ‰“é–‹</p>
         </div>
         <div id="gift-result" class="text-center">
            </div>
    </div>

    <div id="blessings-container" class="hidden fixed top-0 left-0 w-full h-full bg-black z-50 flex-col justify-center items-center p-4">
        <h2 id="blessings-title" class="text-3xl md:text-4xl font-bold mb-4 accent-color text-center">ä¾†è‡ªé æ–¹çš„ç¥ç¦</h2>
        <div id="video-player-wrapper" class="w-full max-w-3xl aspect-video bg-black rounded-lg">
            <video id="blessings-video" class="w-full h-full" controls>
                </video>
        </div>
        <p id="video-playlist" class="text-gray-400 mt-2 h-6"></p>
        <button id="close-blessings" class="absolute top-4 right-4 text-3xl text-white hover:text-gray-400">Ã—</button>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- å¯†ç¢¼è¨­å®š ---
            // è«‹åœ¨é€™è£¡ä¿®æ”¹æˆä½ æƒ³è¨­å®šçš„å¯†ç¢¼
            const PASSWORD = 'chen09';
            // --- è¨­å®šçµæŸ ---

            // --- é–‹ç™¼è¨­å®š ---
            // å°‡æ­¤è¨­å®šç‚º true å¯ä»¥è§£é–æ‰€æœ‰æ—¥æœŸï¼Œæ–¹ä¾¿æ¸¬è©¦èˆ‡ä¿®æ”¹ã€‚
            // æ­£å¼ç™¼ä½ˆçµ¦å°æ–¹å‰ï¼Œè«‹å‹™å¿…æ”¹å› falseï¼
            const UNLOCK_ALL_DATES = true;
            // --- è¨­å®šçµæŸ ---
            
            // --- åœ–ç‰‡è·¯å¾‘ç®¡ç† ---
            // æŠŠä½ ä¸Šå‚³åˆ° GitHub çš„åœ–ç‰‡è·¯å¾‘ï¼Œçµ±ä¸€å¡«å¯«åœ¨é€™è£¡
            const imagePaths = {
                landingBackground: 'https://placehold.co/1920x1080/0d1b2a/e0e1dd?text=æˆ‘å€‘çš„æ•…äº‹',
                day2_blurred: 'image/IMG_7615.jpeg',
                day11_left: 'image/IMG_3758.jpeg',
                day11_right: 'image/0910.png',
                day17_puzzle: 'image/20220501_173850_Original.jpeg',
                day25_1: 'image/day25_1.jpeg',
                day25_2: 'image/day25_2.jpeg',
                day25_3: 'image/day25_3.jpeg',
                day25_4: 'image/day25_4.jpeg',
                day25_5: 'image/day25_5.jpeg',
                day25_6: 'image/day25_6.jpeg',
                day25_7: 'image/day25_7.jpeg',
                day28_photo: 'image/IMG_7781.jpeg',
                day30_memory: 'https://placehold.co/600x400/1b263b/e0e1dd?text=ç¦å²¡å›æ†¶',
                giftBox: 'image/IMG_7617.jpeg'
            };
            // --- åœ–ç‰‡è·¯å¾‘çµæŸ ---
            
            // --- é€£çµèˆ‡å½±ç‰‡ç®¡ç† ---
            const linkPaths = {
                day7_spotify: 'https://open.spotify.com/playlist/4cIIUR6AHQsudqNdhOfQN2?si=i04RwpqoSXqXqRdjIf1tyg&pi=CXbAyX0zT-6J6',
                day26_spotify: 'https://open.spotify.com/',
                // (æ–°å¢çš„) è«‹åœ¨æ­¤è™•åŠ å…¥æ‚¨æ‰€æœ‰ç¥ç¦å½±ç‰‡çš„è·¯å¾‘
                day27_videos: [
                    'recorder/0927-1.mp4',
                    'recorder/0927_2.mp4',
                    // å¦‚æœæœ‰æ›´å¤šå½±ç‰‡ï¼Œè«‹ç¹¼çºŒå¾€ä¸‹åŠ ï¼Œä¾‹å¦‚: 'recorder/0927_3.mp4',
                ]
            };
            // --- é€£çµç®¡ç†çµæŸ ---

            const surprises = {
                1: { 
                    title: "æ­¡è¿ä¾†åˆ°ä½ çš„é©šå–œæœˆï¼",
                    content: `
                        <h3 class="text-2xl font-bold accent-color mb-4">çµ¦æˆ‘çš„å£½æ˜Ÿï¼š</h3>
                        <p class="text-lg">æ­¡è¿ä¾†åˆ°é€™å€‹å°ˆå±¬æ–¼ä½ çš„ç”Ÿæ—¥é©šå–œæœˆï¼å¾ä»Šå¤©èµ·ï¼Œé€™è£¡æ¯å¤©éƒ½æœƒæœ‰ä¸€å€‹å°ç§˜å¯†ï¼Œå¯èƒ½æ˜¯æˆ‘å€‘çš„å›æ†¶ã€æœ‰è¶£çš„å°éŠæˆ²ï¼Œæˆ–æ˜¯å¯ä»¥å…Œç¾çš„çœŸå¯¦ç¦®ç‰©ã€‚æº–å‚™å¥½ï¼Œè®“æˆ‘å€‘ä¸€èµ·å€’æ•¸å§ï¼</p>
                        <button id="claim-gift-btn" class="mt-6 w-full accent-bg hover-accent-bg text-white font-bold py-3 px-4 rounded">é ˜å–ç¬¬ä¸€ä»½ç¦®ç‰©</button>
                    `,
                    gameInit: () => {
                        document.getElementById('claim-gift-btn').addEventListener('click', () => {
                            const modal = document.getElementById('surprise-modal');
                            modal.style.display = 'none';
                            showGiftReveal(surprises['1-gift']);
                        });
                    }
                },
                '1-gift': {
                    type: 'gift',
                    content: `
                        <h3 class="text-2xl font-bold accent-color mb-4">æ­å–œä½ ç²å¾—ï¼š</h3>
                        <p class="text-4xl font-bold my-4">Fujifilm X-M5</p>
                        <p>å¸Œæœ›ä½ å–œæ­¡é€™ä»½ç¦®ç‰©ï¼Œç”¨å®ƒä¾†è¨˜éŒ„æˆ‘å€‘æœªä¾†æ›´å¤šçš„ç¾å¥½ç¬é–“ï¼</p>
                    `
                },
                2: {
                    title: "åœ°é»å¤§è€ƒé©—",
                    content: `
                        <h3 class="text-2xl font-bold accent-color mb-4">çŒœçŒœé€™æ˜¯å“ªè£¡ï¼Ÿ</h3>
                        <img id="blurred-image" src="${imagePaths.day2_blurred}" alt="æ¨¡ç³Šçš„ç…§ç‰‡" class="w-full rounded-lg mb-4 cursor-pointer" style="filter: blur(8px);">
                        <p id="reveal-answer-text" class="text-center">ï¼ˆé»æ“Šåœ–ç‰‡æ­æ›‰ç­”æ¡ˆï¼‰</p>
                        <div id="answer-container" class="hidden text-center mt-4">
                            <p class="text-lg accent-color">2024/02/19 17:30 @ round round</p>
                            <p class="text-lg accent-color">è¶…å–œæ­¡æˆ‘å€‘çš„æ¯æ¯<3</p>
                            <p class="text-lg accent-color">å¯æƒœç¾åœ¨å·²ç¶“æš«åœç‡Ÿæ¥­äº†ï¼±ï¼±</p>
                        </div>
                    `,
                    gameInit: () => {
                        const img = document.getElementById('blurred-image');
                        const revealText = document.getElementById('reveal-answer-text');
                        const answerContainer = document.getElementById('answer-container');
                        img.addEventListener('click', () => {
                            img.style.filter = 'blur(0)';
                            revealText.textContent = ''; // Hide the reveal text
                            answerContainer.classList.remove('hidden'); // Show the answer
                        }, { once: true });
                    }
                },
                3: {
                    title: "ç™¢ç™¢æŠ“æŠ“å·",
                    content: `<div class="border-4 border-dashed p-8 rounded-lg text-center bg-gray-800" style="border-color: #778da9;"><h4 class="text-3xl font-bold text-white mb-4">ç™¢ç™¢æŠ“æŠ“å·</h4><p class="text-lg mb-6">ç•¶ä½ è¦ºå¾—èƒŒå¾ˆç™¢åˆæŠ“ä¸åˆ°æ™‚ï¼Œæ­¤åˆ¸å¯å¬å–šã€Œä¸æ±‚äººã€å¹«ä½ æŠ“åˆ°ç™¢ï¼</p></div>`
                },
                4: {
                    title: "å‹‡è€…ä»»å‹™å¡ #1",
                    content: `<div class="p-4 bg-gray-800 rounded-lg"><h4 class="text-xl font-bold accent-color mb-2">è¡—é ­è—è¡“å®¶æŒ‘æˆ°</h4><p>ä»»å‹™ï¼šæ‰¾ä¸€å€‹ä¸‹åˆï¼Œæˆ‘å€‘ä¸€èµ·å»è²·ç•«å†Šå’Œè‰²ç­†ï¼Œåœ¨å…¬åœ’è£¡ç‚ºå°æ–¹ç•«ä¸€å¹…è‚–åƒç•«ã€‚</p><hr class="my-2 border-gray-600"><p><strong>çå‹µï¼š</strong>ä»»å‹™å®Œæˆå¾Œï¼Œæˆ‘æœƒæŠŠä½ çš„ã€Œå¤§ä½œã€è£±æ¡†èµ·ä¾†ï¼Œä¸¦è«‹ä½ å–ä¸€æ¯ä½ æœ€æ„›çš„æ‰‹æ–é£²ï¼</p></div>`
                },
                5: {
                    title: "æœªä¾†è—åœ–ç”¢ç”Ÿå™¨",
                    content: `
                        <h3 class="text-2xl font-bold accent-color mb-4 text-center">ä¾†å¡«å¯«æˆ‘å€‘çš„æœªä¾†è—åœ–ï¼</h3>
                        <div id="future-blueprint" class="bg-gray-800 p-6 rounded-lg">
                            <div class="text-lg space-y-2">
                                <p>ä¸€å¹´å¾Œï¼Œæˆ‘å€‘è¦ä¸€èµ·å» <input type="text" placeholder="ä¸€å€‹åœ°é»" class="w-24 bg-gray-700 rounded text-center">ï¼Œ</p>
                                <p>ç„¶å¾Œä¸€èµ· <input type="text" placeholder="åšä¸€ä»¶äº‹" class="w-24 bg-gray-700 rounded text-center">ï¼Œ</p>
                                <p>æœ€å¾Œè¦ä¸€èµ·åƒ <input type="text" placeholder="ä¸€ç¨®é£Ÿç‰©" class="w-24 bg-gray-700 rounded text-center">ã€‚</p>
                            </div>
                        </div>
                        <button id="save-blueprint-btn" class="accent-bg hover-accent-bg text-white font-bold py-2 px-4 rounded mt-4 block mx-auto">æˆªåœ–å­˜æª”</button>
                    `,
                    gameInit: () => {
                        document.getElementById('save-blueprint-btn').addEventListener('click', () => {
                            const blueprint = document.getElementById('future-blueprint');
                            html2canvas(blueprint, { backgroundColor: '#1f2937' }).then(canvas => {
                                const link = document.createElement('a');
                                link.download = 'our-future-blueprint.png';
                                link.href = canvas.toDataURL('image/png');
                                link.click();
                            });
                        });
                    }
                },
                6: {
                    title: "ä»Šæ—¥é‹å‹¢å°é¤…ä¹¾",
                    content: `
                        <h3 class="text-2xl font-bold accent-color mb-4 text-center">æ‰“é–‹ä»Šå¤©çš„å¹¸é‹</h3>
                        <div id="fortune-cookie" class="text-center cursor-pointer">
                            <i class="fas fa-cookie-bite text-9xl text-yellow-200"></i>
                            <p class="mt-4">ï¼ˆé»æˆ‘æ‰“é–‹ï¼‰</p>
                        </div>
                        <div id="fortune-text" class="hidden text-center p-4 bg-gray-800 rounded-lg mt-4">
                            <p class="text-xl">ã€Œä»Šæ—¥å®œï¼šç·Šç·ŠæŠ±ä½èº«é‚Šçš„äººï¼Œæœƒç²å¾—æ„æƒ³ä¸åˆ°çš„èƒ½é‡ã€‚ã€</p>
                        </div>
                    `,
                    gameInit: () => {
                        const cookie = document.getElementById('fortune-cookie');
                        const fortuneText = document.getElementById('fortune-text');
                        cookie.addEventListener('click', () => {
                            cookie.classList.add('cracking');
                            setTimeout(() => {
                                cookie.style.display = 'none';
                                fortuneText.classList.remove('hidden');
                            }, 800);
                        }, { once: true });
                    }
                },
                7: {
                    title: "å°ˆå±¬æ­Œå–®",
                    content: `
                        <h3 class="text-2xl font-bold accent-color mb-4">é€™é¦–æ­Œï¼Œè®“æˆ‘æƒ³èµ·...</h3>
                        <p class="mb-4">æˆ‘æŠŠæƒ³èªªçš„è©±ï¼Œæ”¾é€²äº†é€™å¼µæ­Œå–®è£¡ã€‚é»é–‹ä¾†è½è½ï¼Œçœ‹çœ‹ä½ å–œä¸å–œç¿»ï¼Ÿ</p>
                        <a href="${linkPaths.day7_spotify}" target="_blank" class="block accent-bg hover-accent-bg text-white font-bold py-3 px-4 rounded text-center">é»æˆ‘æ’­æ”¾æ•…äº‹æ­Œå–® <i class="fab fa-spotify ml-2"></i></a>
                    `
                },
                8: {
                    title: "é€±ä¸€èƒ½é‡è£œçµ¦",
                    type: 'monday',
                    content: `
                        <h3 class="text-2xl font-bold accent-color mb-4">æœ¬é€±å¹¸é‹ç‰©ï¼šä¸€æ¯å†°ç¾å¼</h3>
                        <div class="bg-gray-800 p-6 rounded-lg text-center">
                            <i class="fas fa-mug-hot text-6xl text-amber-200 mb-4"></i>
                            <p class="text-xl">å®ƒæœƒåœ¨ä½ æœ€éœ€è¦çš„æ™‚å€™ï¼Œçµ¦ä½ åŠ›é‡ã€‚ç¥ä½ æ–°çš„ä¸€é€±å……æ»¿èƒ½é‡ï¼</p>
                            <div class="my-4">
                                <p class="mb-2 text-gray-400">ä¹Ÿè½è½æˆ‘æƒ³å°ä½ èªªçš„è©±ï¼š</p>
                                <audio id="day8-audio" controls class="w-full">
                                    <source src="recorder/day8.m4a" type="audio/mp4">
                                    æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´éŸ³æª”æ’­æ”¾ã€‚
                                </audio>
                            </div>
                        </div>
                    `,
                    gameInit: () => {
                        const audio = document.getElementById('day8-audio');
                        if (audio) {
                            // The monday-motivation animation takes 4.5s (3s for title, 1.5s for content)
                            // We try to play the audio after the content is visible.
                            setTimeout(() => {
                                audio.play().catch(e => {
                                    console.log("ç€è¦½å™¨å¯èƒ½å·²é˜»æ­¢è‡ªå‹•æ’­æ”¾ï¼Œéœ€è¦ä½¿ç”¨è€…äº’å‹•ã€‚");
                                });
                            }, 1500);
                        }
                    }
                },
                9: {
                    title: "æ°£å™—å™—æ¶ˆæ°£å¡",
                    content: `<div class="border-4 border-dashed p-8 rounded-lg text-center bg-gray-800" style="border-color: #778da9;"><h4 class="text-3xl font-bold text-white mb-4">æ°£å™—å™—æ¶ˆæ°£å¡</h4><p class="text-lg mb-6">ç•¶ä½ ç”Ÿæ°£æ™‚ï¼Œå‡ºç¤ºæ­¤å¡ï¼Œæˆ‘æœƒç«‹åˆ»åœæ­¢çˆ­è¾¯ï¼Œä¸¦çµ¦ä½ ä¸€å€‹å¤§å¤§çš„æ“æŠ±è®“ä½ æ¶ˆæ°£ã€‚</p></div>`
                },
                10: {
                    title: "å¹¸é‹åˆ®åˆ®æ¨‚",
                    content: `
                        <h3 class="text-2xl font-bold accent-color mb-4">åˆ®é–‹ä»Šå¤©çš„å¹¸é‹ï¼</h3>
                        <div id="scratch-container">
                            <div id="scratch-prize"><p class="text-2xl">ğŸ‰ çå“ï¼šé™³å‚‘æ†²çé‡‘1000å…ƒï¼ ğŸ‰</p></div>
                            <canvas id="scratch-card" width="400" height="100"></canvas>
                        </div>
                    `,
                    gameInit: () => {
                        const canvas = document.getElementById('scratch-card');
                        const container = document.getElementById('scratch-container');
                        
                        canvas.width = container.clientWidth;
                        canvas.height = container.clientHeight;

                        const ctx = canvas.getContext('2d');
                        ctx.fillStyle = '#778da9';
                        ctx.fillRect(0, 0, canvas.width, canvas.height);

                        let isDrawing = false;
                        const scratch = (e) => {
                            if (!isDrawing) return;
                            e.preventDefault();
                            const rect = canvas.getBoundingClientRect();
                            const x = (e.clientX || e.touches[0].clientX) - rect.left;
                            const y = (e.clientY || e.touches[0].clientY) - rect.top;
                            ctx.globalCompositeOperation = 'destination-out';
                            ctx.beginPath();
                            ctx.arc(x, y, 15, 0, Math.PI * 2);
                            ctx.fill();
                        };

                        canvas.addEventListener('mousedown', () => isDrawing = true);
                        canvas.addEventListener('mouseup', () => isDrawing = false);
                        canvas.addEventListener('mousemove', scratch);
                        canvas.addEventListener('touchstart', () => isDrawing = true, { passive: false });
                        canvas.addEventListener('touchend', () => isDrawing = false);
                        canvas.addEventListener('touchmove', scratch, { passive: false });
                    }
                },
                11: {
                    title: "å¤§å®¶ä¾†æ‰¾ç¢´",
                    content: `
                        <h3 class="text-2xl font-bold accent-color mb-4">ä½ æ‰¾å¾—åˆ° 3 å€‹ä¸åŒçš„åœ°æ–¹å—ï¼Ÿ</h3>
                        <div class="grid grid-cols-2 gap-2">
                            <div>
                                <img src="${imagePaths.day11_left}" alt="åœ–ç‰‡å·¦" class="w-full rounded-lg">
                            </div>
                            <div id="spot-the-diff-container">
                                <img src="${imagePaths.day11_right}" alt="åœ–ç‰‡å³" class="w-full rounded-lg">
                                
                                <div class="diff-circle" style="top: 12%; left: 70%; width: 8%; height: 13%;"></div>
                                
                                <div class="diff-circle" style="top: 82%; left: 42%; width: 18%; height: 20%;"></div>
                                
                                <div class="diff-circle" style="top: 70%; left: 20%; width: 18%; height: 10%;"></div>
                
                            </div>
                        </div>
                        <p id="diff-win" class="text-center mt-4 hidden text-xl accent-color">å¤ªå²å®³äº†ï¼Œå…¨éƒ¨æ‰¾åˆ°äº†ï¼</p>
                    `,
                    gameInit: () => {
                        let foundCount = 0;
                        const totalDiffs = 3; // ç¸½å…±æœ‰ 3 å€‹ä¸åŒé»
                        const winMessage = document.getElementById('diff-win');
                        document.querySelectorAll('.diff-circle').forEach(circle => {
                            circle.addEventListener('click', (e) => {
                                if (!e.target.classList.contains('found')) {
                                    e.target.classList.add('found');
                                    foundCount++;
                                    if (foundCount === totalDiffs) {
                                        winMessage.classList.remove('hidden');
                                    }
                                }
                            }, { once: true });
                        });
                    }
                },
                12: {
                    title: "ç„¡æ¢ä»¶èª‡èª‡å¡",
                    content: `<div class="border-4 border-dashed p-8 rounded-lg text-center bg-gray-800" style="border-color: #778da9;"><h4 class="text-3xl font-bold text-white mb-4">ç„¡æ¢ä»¶èª‡èª‡å¡</h4><p class="text-lg mb-6">ç•¶ä½ éœ€è¦ä¿¡å¿ƒæ™‚ï¼Œè«‹ä½¿ç”¨æ­¤å¡ã€‚æˆ‘æœƒç«‹åˆ»åŒ–èº«ä½ çš„é ­è™Ÿç²‰çµ²ï¼Œåœ¨ä¸‰åˆ†é˜å†…ä¸æ–·åœ°ç¨±è®šä½ ï¼</p></div>`
                },
                13: {
                    title: "å‘½é‹ç¡¬å¹£",
                    content: `
                        <h3 class="text-2xl font-bold accent-color mb-4 text-center">ä»Šæ™š... äº¤çµ¦å‘½é‹æ±ºå®šå§ï¼</h3>
                        <div class="coin-container mb-6 flex justify-center">
                            <div id="coin" class="coin">
                                <div class="face heads">çœ‹å¤œæ™¯</div>
                                <div class="face tails">åƒå¥½æ–™</div>
                            </div>
                        </div>
                        <button id="flipButton" class="w-full accent-bg hover-accent-bg text-white font-bold py-3 px-4 rounded-lg disabled:bg-gray-500">æ‹‹ç¡¬å¹£</button>
                        <p id="result" class="mt-4 text-2xl font-semibold h-8 text-center"></p>
                    `,
                    gameInit: () => {
                        const coin = document.getElementById('coin');
                        const flipButton = document.getElementById('flipButton');
                        const resultText = document.getElementById('result');
                        const coinContainer = document.querySelector('.coin-container'); 
                        let currentRotation = 0;

                        flipButton.addEventListener('click', () => {
                            flipButton.disabled = true;
                            resultText.textContent = '';
                            
                            // è§¸ç™¼æ‹‹æ¥å‹•ç•«
                            coinContainer.classList.remove('is-tossing');
                            void coinContainer.offsetWidth; // å¼·åˆ¶ç€è¦½å™¨é‡æ–°æ¸²æŸ“
                            coinContainer.classList.add('is-tossing');

                            const isHeads = Math.random() < 0.5;
                            const randomFlips = 5 * 360;
                            const resultRotation = isHeads ? 0 : 180;
                            currentRotation += randomFlips + resultRotation;
                            
                            coin.style.transform = `rotateX(${currentRotation}deg)`;

                            setTimeout(() => {
                                if (isHeads) {
                                    resultText.textContent = 'çµæœï¼šçœ‹å¤œæ™¯ï¼';
                                } else {
                                    resultText.textContent = 'çµæœï¼šåƒå¥½æ–™ï¼';
                                }
                                flipButton.disabled = false;
                                coinContainer.classList.remove('is-tossing');
                            }, 1500);
                        });
                    }
                },
                14: {
                    title: "ä½ æ˜¯100åˆ†",
                    content: `
                        <div class="p-8 text-center">
                            <p class="text-gray-400 mb-8">æ•¸å­—æœƒä¸€ç›´è·‘ï¼Œä½ çš„ç›®æ¨™æ˜¯ç²¾æº–åœ°åœ¨ç¢¼éŒ¶é¡¯ç¤ºç‚º"100"æ™‚æŒ‰ä¸‹æŒ‰éˆ•ï¼</p>
                            <div id="timer-display" class="mb-8 text-6xl font-bold text-white">000</div>
                            <div>
                                <button id="mainButton" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-xl shadow-lg transition-all duration-200 ease-in-out transform hover:scale-105">
                                    é–‹å§‹
                                </button>
                            </div>
                            <div id="resultMessage" class="mt-8 text-xl font-semibold"></div>
                        </div>
                    `,
                    gameInit: () => {
                        const display = document.getElementById('timer-display');
                        const mainButton = document.getElementById('mainButton');
                        const resultMessage = document.getElementById('resultMessage');

                        let timer = null;
                        let count = 0;
                        let isRunning = false;

                        function updateDisplay() {
                            display.textContent = String(count).padStart(3, '0');
                        }

                        function handleButtonClick() {
                            if (!isRunning) {
                                // é–‹å§‹éŠæˆ²
                                count = 0;
                                updateDisplay();
                                resultMessage.textContent = '';
                                
                                mainButton.textContent = 'æš«åœ';
                                mainButton.classList.remove('bg-blue-500', 'hover:bg-blue-600');
                                mainButton.classList.add('bg-red-500', 'hover:bg-red-600');

                                isRunning = true;
                                timer = setInterval(() => {
                                    count++;
                                    updateDisplay();
                                }, 50);
                            } else {
                                // æš«åœéŠæˆ²
                                clearInterval(timer);
                                isRunning = false;
                                
                                mainButton.textContent = 'é‡æ–°é–‹å§‹';
                                mainButton.classList.remove('bg-red-500', 'hover:bg-red-600');
                                mainButton.classList.add('bg-blue-500', 'hover:bg-blue-600');
                                
                                if (count === 100) {
                                    resultMessage.textContent = 'æ­å–œä½ ï¼å®Œç¾åœåœ¨100ï¼æ­å–œç²å¾—1000å…ƒçå‹µé‡‘ï¼ğŸ‰';
                                    resultMessage.className = 'mt-8 text-xl font-semibold text-green-400';
                                } else if ((count >= 95 && count <= 99) || (count >= 101 && count <= 105)) {
                                    resultMessage.textContent = `å¾ˆæ¥è¿‘äº†ï¼åœåœ¨ ${count}ï¼Œæ­å–œç²å¾—500å…ƒçå‹µé‡‘ï¼ğŸ’°`;
                                    resultMessage.className = 'mt-8 text-xl font-semibold text-yellow-400';    
                                } else {
                                    resultMessage.textContent = `ä½ åœåœ¨ ${count}ï¼Œå†è©¦è©¦çœ‹ï¼`;
                                    resultMessage.className = 'mt-8 text-xl font-semibold text-red-400';
                                }
                            }
                        }
                        mainButton.addEventListener('click', handleButtonClick);
                    }
                },
                15: {
                    title: "é€±ä¸€åŠ æ²¹ç«™",
                    type: 'monday',
                    openingTitle: 'çµ¦ä½ åŠ›é‡ï¼',
                    content: `<h3 class="text-2xl font-bold accent-color mb-4">ä»Šå¤©çš„æŒ‘æˆ°æ˜¯...</h3><div class="bg-gray-800 p-6 rounded-lg text-center"><i class="fas fa-bullseye text-6xl text-red-400 mb-4"></i><p class="text-xl">å°ä»Šå¤©ç¬¬ä¸€å€‹é‡åˆ°çš„åŒäº‹èªªæ—©å®‰ï¼Œä¸¦çµ¦ä»–ä¸€å€‹å¤§å¤§çš„å¾®ç¬‘ã€‚å®Œæˆå¾Œï¼Œä½ æœƒç™¼ç¾ä¸€æ•´å¤©éƒ½é †åˆ©èµ·ä¾†ï¼</p><hr class="my-4 border-gray-600">/div>`
                },
                16: {
                    title: "å‹‡è€…ä»»å‹™å¡ #2",
                    content: `<div class="p-4 bg-gray-800 rounded-lg"><h4 class="text-xl font-bold accent-color mb-2">å›æ†¶å¾©åˆ»æŒ‘æˆ°</h4><p>ä»»å‹™ï¼šæ‰¾å‡ºæˆ‘å€‘çš„ä¸€å¼µèˆŠåˆç…§ï¼Œé€™å€‹é€±æœ«ï¼Œæˆ‘å€‘è¦æ‰¾åˆ°ç›¸ä¼¼çš„å ´æ™¯å’Œè¡£æœï¼Œå®Œç¾å¾©åˆ»å®ƒï¼</p><hr class="my-2 border-gray-600"><p><strong>çå‹µï¼š</strong>æˆåŠŸå¾Œï¼Œæˆ‘æœƒæŠŠæ–°èˆŠç…§ç‰‡æ²–æ´—å‡ºä¾†ï¼Œè£±åœ¨ä¸€å€‹ã€Œä»Šæ˜”å°æ¯”ã€çš„ç›¸æ¡†è£¡ï¼Œä¸¦è«‹ä½ å–æ¯å’–å•¡ï¼</p></div>`
                },
                17: {
                    title: "è¨˜æ†¶æ‹¼åœ–",
                    content: `
                        <h3 class="text-2xl font-bold accent-color mb-4">æ‹¼æ¹Šå›æ†¶</h3>
                        <div id="puzzle-container"></div>
                        <p id="puzzle-win" class="text-center mt-4 hidden text-xl accent-color">å®Œæˆå›‰ï¼å¿«æ¨‚çš„å›æ†¶ï¼Œä¸€å¡Šéƒ½ä¸èƒ½å°‘ã€‚</p>
                    `,
                    gameInit: () => {
                        const container = document.getElementById('puzzle-container');
                        container.innerHTML = '';
                        const winMessage = document.getElementById('puzzle-win');
                        winMessage.classList.add('hidden');

                        let pieces = [];
                        let selected = null;
                        // --- ä¿®æ”¹é€™è£¡ ---
                        const gridSize = 3;
                        const pieceCount = gridSize * gridSize;
                        const pieceWidth = 100;
                        const pieceHeight = 133;
                        const correctOrder = Array.from({length: pieceCount}, (_, i) => i);
                        let currentOrder = [...correctOrder].sort(() => Math.random() - 0.5);
                        // --- ä¿®æ”¹çµæŸ ---

                        const createPieces = () => {
                            container.innerHTML = '';
                            pieces = [];
                            // --- ä¿®æ”¹é€™è£¡ ---
                            for (let i = 0; i < pieceCount; i++) {
                                const piece = document.createElement('div');
                                piece.classList.add('puzzle-piece');
                                piece.style.backgroundImage = `url(${imagePaths.day17_puzzle})`;
                                const originalIndex = currentOrder[i];
                                const row = Math.floor(originalIndex / gridSize);
                                const col = originalIndex % gridSize;
                                piece.style.backgroundPosition = `${-col * pieceWidth}px ${-row * pieceHeight}px`;
                                piece.dataset.index = i;
                                piece.addEventListener('click', onPieceClick);
                                container.appendChild(piece);
                                pieces.push(piece);
                            }
                            // --- ä¿®æ”¹çµæŸ ---
                        };
                        
                        const onPieceClick = (e) => {
                            const piece = e.target;
                            if (selected === null) {
                                selected = piece;
                                piece.classList.add('selected');
                            } else {
                                if (selected !== piece) {
                                    const index1 = parseInt(selected.dataset.index);
                                    const index2 = parseInt(piece.dataset.index);
                                    [currentOrder[index1], currentOrder[index2]] = [currentOrder[index2], currentOrder[index1]];
                                    // ç§»é™¤ selected class å†é‡æ–°æ¸²æŸ“
                                    selected.classList.remove('selected');
                                    selected = null;
                                    createPieces();
                                } else {
                                     // å¦‚æœé»æ“ŠåŒä¸€å€‹ï¼Œå°±å–æ¶ˆé¸å–
                                     selected.classList.remove('selected');
                                     selected = null;
                                }
                                checkWin();
                            }
                        };

                        const checkWin = () => {
                            if (JSON.stringify(currentOrder) === JSON.stringify(correctOrder)) {
                                winMessage.classList.remove('hidden');
                                // ç§»é™¤é»æ“Šäº‹ä»¶ï¼Œé¿å…å®Œæˆå¾Œé‚„èƒ½æ“ä½œ
                                pieces.forEach(p => p.removeEventListener('click', onPieceClick));
                            }
                        };

                        createPieces();
                    }
                },
                18: {
                    title: "æ·±å¤œå¤–é€æŒ‡å®šå·",
                    content: `<div class="border-4 border-dashed p-8 rounded-lg text-center bg-gray-800" style="border-color: #778da9;"><h4 class="text-3xl font-bold text-white mb-4">æ·±å¤œé£Ÿå ‚æŒ‡å®šå·</h4><p class="text-lg mb-6">ä¸ç®¡å¤šæ™šï¼Œåªè¦ä½ æƒ³åƒå®µå¤œï¼Œæ†‘æ­¤åˆ¸å¯ä»»æ„æŒ‡å®šä¸€æ¨£å«åˆ°çš„å®µå¤œï¼</p></div>`
                },
                19: {
                    title: "å‹‡è€…ä»»å‹™å¡ #3",
                    content: `<div class="p-4 bg-gray-800 rounded-lg"><h4 class="text-xl font-bold accent-color mb-2">ä¸€å°æ™‚å¤–èªæŒ‘æˆ°</h4><p>ä»»å‹™ï¼šé¸ä¸€ç¨®æˆ‘å€‘éƒ½å®Œå…¨ä¸æœƒçš„èªè¨€ï¼Œç”¨Appä¸€èµ·å­¸ç¿’ä¸€å°æ™‚ã€‚çµæŸå¾Œï¼Œè¦ç”¨å­¸åˆ°çš„å–®å­—é€²è¡Œä¸€æ®µä¸‰åˆ†é˜çš„å°è©±ã€‚</p><hr class="my-2 border-gray-600"><p><strong>çå‹µï¼š</strong>æŒ‘æˆ°æˆåŠŸå¾Œï¼Œæˆ‘æœƒè¨‚é‚£å€‹åœ‹å®¶çš„æ–™ç†ç•¶ä½œæˆ‘å€‘çš„æ™šé¤ï¼</p></div>`
                },
                20: {
                    title: "é»˜å¥‘å¤§è€ƒé©—ï¼",
                    content: `
                        <div id="quiz-container">
                            <h3 id="question-text" class="text-2xl font-bold accent-color mb-6 text-center"></h3>
                            <div id="options-container" class="space-y-2"></div>
                            <p id="feedback-text" class="text-center mt-4 h-6"></p>
                            <div id="quiz-results" class="hidden text-center"></div>
                        </div>
                    `,
                    gameInit: () => {
                        // --- åœ¨é€™è£¡ä¿®æ”¹ä½ çš„é¡Œç›® ---
                        const quizQuestions = [
                            {
                                question: "ç¬¬ä¸€æ¬¡ä¸€èµ·æ…¶ç¥ç”Ÿæ—¥æ˜¯åœ¨å“ªå€‹é¤å»³ï¼Ÿ",
                                options: ["TBSå‰”é‚¦é¥ˆ", "é›…ç«¹éµæ¿æ–™ç†", "æ¨‚è‘µæ³•å¼éµæ¿ç‡’"],
                                answer: "é›…ç«¹éµæ¿æ–™ç†",
                                feedback: "ç­”å°äº†ï¼é‚£æ˜¯æˆ‘ç¬¬ä¸€æ¬¡åƒé«˜ç´šéµæ¿ç‡’è¶…ç´šé–‹å¿ƒ,è¬è¬å¯¶å¯¶çš„ç”¨å¿ƒï¼"
                            },
                            {
                                question: "å¾æˆ‘å€‘äº¤å¾€çš„ç¬¬ä¸€å¤©åˆ°ç¾åœ¨ç¸½å…±å¹¾å¤©äº†ï¼Ÿ",
                                options: ["1740å¤©", "1687å¤©", "1314å¤©"],
                                answer: "1740å¤©",
                                feedback: "æ²’éŒ¯ï¼1740å¤©æ¯ä¸€å¤©éƒ½æ˜¯æœ€æ£’çš„ã€‚"
                            },
                            {
                                question: "æˆ‘æœ€å–œæ­¡ä½ çš„å“ªå€‹å„ªé»ï¼Ÿ",
                                options: ["ææ€ªçš„è„¾æ°£", "æº«æŸ”çš„å¿ƒ", "å…¨éƒ¨éƒ½æ˜¯"],
                                answer: "å…¨éƒ¨éƒ½æ˜¯",
                                feedback: "é‚„ç”¨å•å—ï¼Ÿç•¶ç„¶æ˜¯å…¨éƒ¨éƒ½å–œæ­¡ï¼"
                            }
                        ];
                        // --- é¡Œç›®ä¿®æ”¹çµæŸ ---

                        const quizContainer = document.getElementById('quiz-container');
                        const questionText = document.getElementById('question-text');
                        const optionsContainer = document.getElementById('options-container');
                        const feedbackText = document.getElementById('feedback-text');
                        const quizResults = document.getElementById('quiz-results');

                        let currentQuestionIndex = 0;
                        let score = 0;

                        function showQuestion(index) {
                            // Clear previous content
                            optionsContainer.innerHTML = '';
                            feedbackText.textContent = '';
                            quizResults.classList.add('hidden');
                            optionsContainer.style.display = 'block';


                            const q = quizQuestions[index];
                            questionText.textContent = q.question;

                            q.options.forEach(option => {
                                const button = document.createElement('button');
                                button.textContent = option;
                                button.classList.add('quiz-option');
                                button.addEventListener('click', () => selectAnswer(button, option, q));
                                optionsContainer.appendChild(button);
                            });
                        }

                        function selectAnswer(button, selectedOption, questionData) {
                            // Disable all buttons
                            const allOptions = optionsContainer.querySelectorAll('.quiz-option');
                            allOptions.forEach(btn => btn.disabled = true);

                            if (selectedOption === questionData.answer) {
                                button.classList.add('correct');
                                feedbackText.textContent = questionData.feedback;
                                feedbackText.style.color = '#5d9b6a';
                                score++;
                            } else {
                                button.classList.add('incorrect');
                                feedbackText.textContent = 'ç­”éŒ¯äº†ï¼Œå†æƒ³æƒ³ï¼';
                                feedbackText.style.color = '#b56576';
                                // Highlight the correct answer
                                allOptions.forEach(btn => {
                                    if (btn.textContent === questionData.answer) {
                                        btn.classList.add('correct');
                                    }
                                });
                            }

                            // Move to next question or show results
                            setTimeout(() => {
                                currentQuestionIndex++;
                                if (currentQuestionIndex < quizQuestions.length) {
                                    showQuestion(currentQuestionIndex);
                                } else {
                                    showResults();
                                }
                            }, 2000);
                        }
                        
                        function showResults() {
                            questionText.textContent = 'æ¸¬é©—çµæŸï¼';
                            optionsContainer.style.display = 'none';
                            feedbackText.textContent = '';
                            
                            let resultMessage = '';
                            if (score === quizQuestions.length) {
                                resultMessage = `<h3>å¤ªç¥å•¦ï¼${score}/${quizQuestions.length} å…¨å°ï¼</h3><p>çœ‹ä¾†ä½ çœŸçš„å¾ˆè¨˜æ€§å¾ˆå¥½å…§ï¼Œä¸æ„§æ˜¯æˆ‘çš„éˆé­‚ä¼´ä¾¶:)</p>`;
                            } else if (score >= quizQuestions.length / 2) {
                                resultMessage = `<h3>ä¸éŒ¯å–”ï¼ç­”å°äº† ${score}/${quizQuestions.length} é¡Œï¼</h3><p>æˆ‘å€‘çš„é»˜å¥‘é‚„æ˜¯å¾ˆä¸éŒ¯çš„å˜›ï¼</p>`;
                            } else {
                                resultMessage = `<h3>ç­”å°äº† ${score}/${quizQuestions.length} é¡Œ...</h3><p>çœ‹ä¾†éœ€è¦å¤šé»æ™‚é–“è¤‡ç¿’ä¸€ä¸‹æˆ‘å€‘çš„å›æ†¶å–”ï¼±ï¼±ï¼</p>`;
                            }
                            quizResults.innerHTML = resultMessage;
                            quizResults.classList.remove('hidden');
                        }

                        showQuestion(currentQuestionIndex);
                    }
                },
                21: {
                    title: "é»˜å¥‘å¤§è€ƒé©—Part2ï¼!",
                    content: `
                        <div id="quiz-container">
                            <h3 id="question-text" class="text-2xl font-bold accent-color mb-6 text-center"></h3>
                            <div id="options-container" class="space-y-2"></div>
                            <p id="feedback-text" class="text-center mt-4 h-6"></p>
                            <div id="quiz-results" class="hidden text-center"></div>
                        </div>
                    `,
                    gameInit: () => {
                        // --- åœ¨é€™è£¡ä¿®æ”¹ä½ çš„é¡Œç›® ---
                        const quizQuestions = [
                            {
                                question: "èªªåˆ°åˆºé’æœƒæƒ³åˆ°ä»€éº¼",
                                options: ["è…³å¯¶", "è…³è²“", "è…³é¼»"],
                                answer: "è…³å¯¶",
                                feedback: "æˆ‘è¦åˆºä¸€å€‹è…³å¯¶åœ¨èƒ¸å‰"
                            },
                            {
                                question: "ä½ ç©¿éå¹¾é›™530ï¼Ÿ",
                                options: ["3é›™", "4é›™", "2é›™"],
                                answer: "3é›™",
                                feedback: "ä½†ä¹Ÿç ´äº†3é›™530 :Pã€‚"
                            },
                            {
                                question: "æˆ‘åœ¨æƒ³ä»€éº¼ï¼Ÿ",
                                options: ["æˆ‘ä¸é¨™ä½ ", "å–‰åš¨è£¡æœ‰ç´°èŒ", "å³æ¥µé™"],
                                answer: "å–‰åš¨è£¡æœ‰ç´°èŒ",
                                feedback: "æ¯å¤©éƒ½è¦çœ‹æ¹˜è·å¦¹å¦¹è€å¯æ„›ï¼"
                            }
                        ];
                        // --- é¡Œç›®ä¿®æ”¹çµæŸ ---

                        const quizContainer = document.getElementById('quiz-container');
                        const questionText = document.getElementById('question-text');
                        const optionsContainer = document.getElementById('options-container');
                        const feedbackText = document.getElementById('feedback-text');
                        const quizResults = document.getElementById('quiz-results');

                        let currentQuestionIndex = 0;
                        let score = 0;

                        function showQuestion(index) {
                            // Clear previous content
                            optionsContainer.innerHTML = '';
                            feedbackText.textContent = '';
                            quizResults.classList.add('hidden');
                            optionsContainer.style.display = 'block';


                            const q = quizQuestions[index];
                            questionText.textContent = q.question;

                            q.options.forEach(option => {
                                const button = document.createElement('button');
                                button.textContent = option;
                                button.classList.add('quiz-option');
                                button.addEventListener('click', () => selectAnswer(button, option, q));
                                optionsContainer.appendChild(button);
                            });
                        }

                        function selectAnswer(button, selectedOption, questionData) {
                            // Disable all buttons
                            const allOptions = optionsContainer.querySelectorAll('.quiz-option');
                            allOptions.forEach(btn => btn.disabled = true);

                            if (selectedOption === questionData.answer) {
                                button.classList.add('correct');
                                feedbackText.textContent = questionData.feedback;
                                feedbackText.style.color = '#5d9b6a';
                                score++;
                            } else {
                                button.classList.add('incorrect');
                                feedbackText.textContent = 'å’¦çœŸçš„å—ï¼Ÿï¼Œå†æƒ³æƒ³ï¼';
                                feedbackText.style.color = '#b56576';
                                // Highlight the correct answer
                                allOptions.forEach(btn => {
                                    if (btn.textContent === questionData.answer) {
                                        btn.classList.add('correct');
                                    }
                                });
                            }

                            // Move to next question or show results
                            setTimeout(() => {
                                currentQuestionIndex++;
                                if (currentQuestionIndex < quizQuestions.length) {
                                    showQuestion(currentQuestionIndex);
                                } else {
                                    showResults();
                                }
                            }, 2000);
                        }
                        
                        function showResults() {
                            questionText.textContent = 'æ¸¬é©—çµæŸï¼';
                            optionsContainer.style.display = 'none';
                            feedbackText.textContent = '';
                            
                            let resultMessage = '';
                            if (score === quizQuestions.length) {
                                resultMessage = `<h3>å“‡å—šï¼${score}/${quizQuestions.length} å…¨å°å„ªï¼</h3><p>çµ¦ä½ 100æ˜:)</p>`;
                            } else if (score >= quizQuestions.length / 2) {
                                resultMessage = `<h3>ä¸éŒ¯å–”ï¼ç­”å°äº† ${score}/${quizQuestions.length} é¡Œï¼</h3><p>é»˜å¥‘UPUPï¼</p>`;
                            } else {
                                resultMessage = `<h3>ç­”å° ${score}/${quizQuestions.length} é¡Œ...</h3><p>ä¸‹æ¬¡å·å·å¯„è€ƒå¤é¡Œçµ¦ä½ ï¼</p>`;
                            }
                            quizResults.innerHTML = resultMessage;
                            quizResults.classList.remove('hidden');
                        }

                        showQuestion(currentQuestionIndex);
                    }
                },
                22: {
                    title: "é€±ä¸€èƒ½é‡è£œçµ¦",
                    type: 'monday',
                    openingTitle: 'ä½ æ˜¯æœ€æ£’çš„ï¼',
                    content: `<h3 class="text-2xl font-bold accent-color mb-4">æœ¬é€±å¹¸é‹è‰²ï¼šå¤©ç©ºè—</h3><div class="bg-gray-800 p-6 rounded-lg text-center"><i class="fas fa-cloud text-6xl text-sky-400 mb-4"></i><p class="text-xl">å†åŠªåŠ›å¹¾å¤©æˆ‘å€‘å°±è¦å‡ºç™¼ç¦å²¡å›‰ã€‚åŠ æ²¹ï¼</p><hr class="my-4 border-gray-600"></div>`
                },
                23: {
                    title: "å‹‡è€…ä»»å‹™å¡ #4",
                    content: `<div class="p-4 bg-gray-800 rounded-lg"><h4 class="text-xl font-bold accent-color mb-2">ç¾é£Ÿè¼ªç›¤å¤§å†’éšª</h4><p>ä»»å‹™ï¼šæˆ‘å€‘ä¸€èµ·æ‰“é–‹ç¾é£ŸAppï¼Œé–‰ä¸Šçœ¼ç›åœ¨è¢å¹•ä¸Šäº‚æ»‘ï¼Œæ‰‹æŒ‡åœåœ¨å“ªä¸€å®¶æˆ‘å€‘ã€Œå¾æ²’åƒéã€çš„é¤å»³ï¼Œå°±å»åƒé‚£å®¶ï¼</p><hr class="my-2 border-gray-600"><p><strong>çå‹µï¼š</strong>ä¸è«–é€™é¤æ˜¯é©šå–œé‚„æ˜¯é©šåš‡ï¼Œé€™æ¬¡çš„é¤è²»ç”±æˆ‘å…¨é¡è²·å–®ï¼</p></div>`
                },
                24: {
                    title: "è·‘è…¿æˆ‘æœ€è¡Œåˆ¸",
                    content: `<div class="border-4 border-dashed p-8 rounded-lg text-center bg-gray-800" style="border-color: #778da9;"><h4 class="text-3xl font-bold text-white mb-4">è·‘è…¿æˆ‘æœ€è¡Œåˆ¸</h4><p class="text-lg mb-6">çªç„¶æƒ³å–æ‰‹æ–é£²ï¼Ÿç™¼ç¾é¤…ä¹¾åƒå®Œäº†ï¼Ÿæ†‘æ­¤åˆ¸å¯å¬å–šã€Œå°ˆå±¬å¤–é€å“¡ã€å‡ºå‹•ä¸€æ¬¡ï¼</p></div>`
                },
                25: {
                    title: "ç¦å²¡å¿ƒå‹•é€±å•Ÿå‹•",
                    content: `
                        <h3 class="text-2xl font-bold accent-color mb-4">ç¦å²¡å¿ƒå‹•é€± Day 1</h3>
                        <p>æˆ‘å€‘çš„å†’éšªå³å°‡å•Ÿç¨‹ï¼ä¾†å¿«é€Ÿå›é¡§ä¸€ä¸‹é€™æ¬¡çš„å†’éšªåœ°é»ï¼</p>
                        <div id="day25-flash-container" class="flash-image-container mt-4">
                            </div>
                    `,
                    gameInit: () => {
                        const container = document.getElementById('day25-flash-container');
                        if (!container) return;
                
                        // æ•´ç†æ‰€æœ‰è¦æ’­æ”¾çš„åœ–ç‰‡è·¯å¾‘
                        const day25Images = [
                            imagePaths.day25_1, imagePaths.day25_2, imagePaths.day25_3,
                            imagePaths.day25_4, imagePaths.day25_5, imagePaths.day25_6,
                            imagePaths.day25_7
                        ];
                
                        // ç‚ºæ¯å¼µåœ–ç‰‡å»ºç«‹ä¸€å€‹ <img> å…ƒç´ 
                        day25Images.forEach((src, index) => {
                            const img = document.createElement('img');
                            img.src = src;
                            img.classList.add('flash-image');
                            img.alt = `Slide ${index + 1}`;
                            container.appendChild(img);
                        });
                
                        const images = container.querySelectorAll('.flash-image');
                        let currentIndex = 0;
                
                        function showNextImage() {
                            // éš±è—ä¸Šä¸€å¼µåœ–ç‰‡
                            if (images.length > 0) {
                                 const prevIndex = (currentIndex - 1 + images.length) % images.length;
                                 images[prevIndex].classList.remove('visible');
                            }
                            
                            // é¡¯ç¤ºç›®å‰åœ–ç‰‡
                            images[currentIndex].classList.add('visible');
                            
                            // æ›´æ–°åˆ°ä¸‹ä¸€å¼µ
                            currentIndex = (currentIndex + 1) % images.length;
                        }
                
                        // é–‹å§‹æ’­æ”¾
                        showNextImage(); // ç«‹åˆ»é¡¯ç¤ºç¬¬ä¸€å¼µ
                        const slideshowInterval = setInterval(showNextImage, 800);
                        
                        // ç•¶ modal é—œé–‰æ™‚ï¼Œåœæ­¢è¼ªæ’­ï¼Œé¿å…èƒŒæ™¯ç¹¼çºŒè€—èƒ½
                        const modal = document.getElementById('surprise-modal');
                        const observer = new MutationObserver((mutations) => {
                            mutations.forEach((mutation) => {
                                if (mutation.attributeName === 'style' && modal.style.display === 'none') {
                                    clearInterval(slideshowInterval);
                                }
                            });
                        });
                        observer.observe(modal, { attributes: true });
                    }
                },
                26: {
                    title: "ç³¸å³¶çš„å‹‡è€…ä»»å‹™å¡",
                    content: `<div class="p-4 bg-gray-800 rounded-lg"><h4 class="text-xl font-bold accent-color mb-2">ç¦å²¡å¿ƒå‹•é€± Day 2ï¼šç³¸å³¶ä»»å‹™</h4><p>ä»»å‹™ï¼šè«‹ä½ æ”¶é›†ç´ æä¸¦éŒ„è£½ä»Šå¤©ç³»å³¶ä¸€å¤©çš„å°çŸ­ç‰‡ï¼</p><hr class="my-2 border-gray-600"><p><strong>çå‹µï¼š</strong>å•¾å•¾ä¸€æšï¼</p><img src="${imagePaths.day25_4}" class="w-full rounded-lg mt-4"></div>`
                },
                27: { title: "ç”Ÿæ—¥å¿«æ¨‚ï¼", type: 'fireworks' },
                28: {
                    title: "æ—…è¡Œä¸­çš„æŒ‡å®šä»»å‹™",
                    content: `<h3 class="text-2xl font-bold accent-color mb-4">ç¦å²¡å¿ƒå‹•é€± Day 4</h3><div class="p-4 bg-gray-800 rounded-lg"><h4 class="text-xl font-bold accent-color mb-2">ä¾¿åˆ©å•†åº—å¤§æ¢éšª</h4><p>ä»Šæ—¥ä»»å‹™ï¼šæ‰¾åˆ°ä¸€å®¶æœ€ç‰¹åˆ¥çš„ä¾¿åˆ©å•†åº—ï¼Œè²·ä¸€ç“¶å¾æ²’å–éçš„é£²æ–™ï¼Œç„¶å¾Œè·Ÿæˆ‘åˆ†äº«ï¼</p></div>`
                },
                29: {
                    title: "ä¸€å¹´å‰çš„ä»Šå¤©",
                    
                    content: `<h3 class="text-2xl font-bold accent-color mb-4">ç¦å²¡å¿ƒå‹•é€± Day 5</h3><div class="p-4 text-center"><img src="${imagePaths.day28_photo}" class="w-full rounded-lg mb-4"><p class="text-xl leading-relaxed">ã€Œä¸€å¹´å‰çš„ä»Šå¤©ï¼Œä½ å†è·Ÿæ±äº¬éƒµç­’æ‹ç…§å“ˆå“ˆå“ˆã€‚ä¸€å¹´å¾Œçš„ä»Šå¤©ï¼Œæˆ‘å€‘æ›åœ¨ç¦å²¡é–‘æ™ƒï¼ã€</p></div>`
                },
                30: { 
                    title: "ç¦å²¡å›æ†¶éŒ„", 
                    content: `<h3 class="text-2xl font-bold accent-color mb-4">ç¦å²¡å¿ƒå‹•é€± Day 6</h3><div class="w-full h-64 bg-gray-800 rounded-lg flex items-center justify-center mb-4"><img src="${imagePaths.day25_4}" class="max-w-full max-h-full rounded-lg"></div><p>é€™è¶Ÿæ—…ç¨‹å› ç‚ºä½ è€Œå®Œç¾ã€‚æˆ‘å€‘çš„æ•…äº‹ï¼Œæœªå®Œå¾…çºŒ... è¦ªæ„›çš„ï¼Œä¸‹ä¸€ç«™ä½ æƒ³å»å“ªï¼Ÿ</p>`
                }
            };

            const startButton = document.getElementById('start-button');
            const landingPage = document.getElementById('landing-page');
            const surpriseContainer = document.getElementById('surprise-container');
            const calendarGrid = document.getElementById('calendar-grid');
            const modal = document.getElementById('surprise-modal');
            const modalBody = document.getElementById('modal-body');
            const modalCloseButton = document.querySelector('.modal .close-button');
            const fireworksContainer = document.getElementById('fireworks-container');
            const birthdayTitle = document.getElementById('birthday-title');
            const personalMessage = document.getElementById('personal-message');
            const canvas = document.getElementById('fireworks-canvas');
            const mondayContainer = document.getElementById('monday-motivation-container');
            const mondayTitle = document.querySelector('#monday-title h1');
            const mondayContentWrapper = document.getElementById('monday-content-wrapper');
            const mondayCloseButton = document.querySelector('#monday-motivation-container .close-button');
            const passwordGate = document.getElementById('password-gate');
            const passwordInput = document.getElementById('password-input');
            const passwordSubmit = document.getElementById('password-submit');
            const passwordError = document.getElementById('password-error');
            const giftContainer = document.getElementById('gift-reveal-container');
            const giftBox = document.getElementById('gift-box');
            const giftResult = document.getElementById('gift-result');
            const giftCloseButton = document.querySelector('#gift-reveal-container .close-button');
            const giftBoxImage = document.querySelector('#gift-box img');
            
            // (æ–°å¢çš„) å–å¾—å½±ç‰‡æ’­æ”¾å™¨ç›¸é—œå…ƒç´ 
            const blessingsContainer = document.getElementById('blessings-container');
            const blessingsVideo = document.getElementById('blessings-video');
            const closeBlessingsButton = document.getElementById('close-blessings');
            const videoPlaylist = document.getElementById('video-playlist');

            // --- Apply Image Paths ---
            document.getElementById('landing-page').style.backgroundImage = `linear-gradient(rgba(13, 27, 42, 0.8), rgba(13, 27, 42, 1)), url('${imagePaths.landingBackground}')`;
            if (giftBoxImage) {
                 giftBoxImage.src = imagePaths.giftBox;
            }

            const today = new Date();
            const currentMonth = today.getMonth();
            const currentDay = today.getDate();
            
            // --- Password Logic ---
            const checkPassword = () => {
                const input = passwordInput.value.trim();
                if (input === PASSWORD) {
                    passwordGate.style.opacity = 0;
                    setTimeout(() => {
                        passwordGate.style.display = 'none';
                        landingPage.style.display = 'flex';
                    }, 500);
                } else {
                    passwordError.textContent = 'å¯†ç¢¼éŒ¯èª¤';
                    passwordInput.value = '';
                }
            };

            passwordSubmit.addEventListener('click', checkPassword);
            passwordInput.addEventListener('keyup', (event) => {
                if (event.key === 'Enter') {
                    checkPassword();
                }
            });


            startButton.addEventListener('click', () => {
                landingPage.style.display = 'none';
                surpriseContainer.style.display = 'block';
            });

            const closeModal = () => {
                modal.style.display = 'none';
                mondayContainer.style.display = 'none';
                giftContainer.style.display = 'none';
                closeBlessings(); // (æ–°å¢çš„) é—œé–‰ modal æ™‚ä¹Ÿé—œé–‰å½±ç‰‡
            };

            modalCloseButton.addEventListener('click', closeModal);
            mondayCloseButton.addEventListener('click', closeModal);
            giftCloseButton.addEventListener('click', closeModal);

            window.addEventListener('click', (event) => {
                if (event.target == modal || event.target == mondayContainer || event.target == giftContainer) {
                    closeModal();
                }
                if (event.target == blessingsContainer) { // é»æ“Šå½±ç‰‡èƒŒæ™¯ä¹Ÿå¯ä»¥é—œé–‰
                    closeBlessings();
                }
            });
            
            fireworksContainer.addEventListener('click', () => {
                fireworksContainer.classList.add('hidden');
                if (animationFrameId) {
                    window.cancelAnimationFrame(animationFrameId);
                    animationFrameId = null;
                }
                 // (æ–°å¢çš„) å¦‚æœç…™ç«è¢«æ‰‹å‹•é—œé–‰ï¼Œä¹Ÿç›´æ¥é¡¯ç¤ºç¥ç¦å½±ç‰‡
                showBlessings();
            });

            // ç”¢ç”Ÿæ—¥æœŸå¡ç‰‡
            for (let day = 1; day <= 30; day++) {
                const card = document.createElement('div');
                card.className = 'day-card flex flex-col items-center justify-center p-4 aspect-square';
                card.dataset.day = day;
                if(day === 27) card.classList.add('accent-bg', 'text-white', 'animate-pulse');

                const dayText = document.createElement('span');
                dayText.className = 'text-3xl font-bold';
                dayText.textContent = day;
                
                const monthText = document.createElement('span');
                monthText.className = 'text-sm';
                monthText.textContent = 'ä¹æœˆ';

                card.appendChild(dayText);
                card.appendChild(monthText);

                // åˆ¤æ–·æ˜¯å¦è§£é–
                if (UNLOCK_ALL_DATES || (currentMonth === 8 && day <= currentDay)) { // 8 ä»£è¡¨ 9 æœˆ (æœˆä»½å¾ 0 é–‹å§‹)
                    card.classList.add('unlocked');
                    card.addEventListener('click', () => openSurprise(day));
                } else {
                    card.classList.add('locked');
                    const lockIcon = document.createElement('i');
                    lockIcon.className = 'fas fa-lock absolute text-lg';
                    card.appendChild(lockIcon);
                    dayText.classList.add('opacity-30');
                    monthText.classList.add('opacity-30');
                }
                calendarGrid.appendChild(card);
            }

            function openSurprise(day) {
                const surprise = surprises[day];
                if (!surprise) {
                    modalBody.innerHTML = `<h2 class="text-3xl font-bold text-white mb-6">æ•¬è«‹æœŸå¾…ï¼</h2><p>ä»Šå¤©çš„é©šå–œé‚„åœ¨åŒ…è£ä¸­...</p>`;
                    modal.style.display = 'block';
                    return;
                }

                if (surprise.type === 'fireworks') {
                    launchFireworks();
                } else if (surprise.type === 'monday') {
                    showMondayMotivation(surprise);
                }
                // Removed the separate 'gift' type check from here
                else {
                    modalBody.innerHTML = `<h2 class="text-3xl font-bold text-white mb-6 border-b-2" style="border-color: #778da9;">${surprise.title}</h2><div>${surprise.content}</div>`;
                    modal.style.display = 'block';
                    if (surprise.gameInit) {
                        surprise.gameInit();
                    }
                }
            }
            
            function showGiftReveal(surprise) {
                giftResult.innerHTML = surprise.content;
                giftResult.classList.remove('visible');
                giftBox.classList.remove('open');
                giftBox.style.display = 'block';
                giftContainer.style.display = 'flex';

                const openGiftHandler = () => {
                    giftBox.classList.add('open');
                    setTimeout(() => {
                        giftBox.style.display = 'none';
                        giftResult.classList.add('visible');
                    }, 1400);
                };
                giftBox.addEventListener('click', openGiftHandler, { once: true });
            }


            function showMondayMotivation(surprise) {
                mondayTitle.textContent = surprise.openingTitle || 'é€±ä¸€åŠ æ²¹ï¼';
                mondayContentWrapper.innerHTML = `<div class="p-4 rounded-lg">${surprise.content}</div>`;
                
                // Reset states
                document.getElementById('monday-title').style.opacity = 1;
                mondayContentWrapper.style.opacity = 0;
                mondayContainer.style.display = 'flex';

                setTimeout(() => {
                    document.getElementById('monday-title').style.opacity = 0;
                    setTimeout(() => {
                        mondayContentWrapper.style.opacity = 1;
                        if (surprise.gameInit) {
                           surprise.gameInit();
                        }
                    }, 1500);
                }, 3000);
            }

            // (æ–°å¢çš„) é¡¯ç¤ºç¥ç¦å½±ç‰‡çš„å‡½å¼
            function showBlessings() {
                // å¦‚æœæ²’æœ‰å½±ç‰‡ï¼Œå°±ç›´æ¥çµæŸ
                if (!linkPaths.day27_videos || linkPaths.day27_videos.length === 0) {
                    console.log("æ²’æœ‰è¨­å®šç¥ç¦å½±ç‰‡ã€‚");
                    return;
                }
                
                blessingsContainer.classList.remove('hidden');
                blessingsContainer.style.display = 'flex';

                let currentVideoIndex = 0;
                const videoSources = linkPaths.day27_videos;

                function playVideo(index) {
                    if (index >= videoSources.length) {
                        // æ‰€æœ‰å½±ç‰‡æ’­æ”¾å®Œç•¢
                        videoPlaylist.textContent = "æ‰€æœ‰ç¥ç¦å·²æ’­æ”¾å®Œç•¢ï¼";
                        setTimeout(closeBlessings, 2000); // 2ç§’å¾Œè‡ªå‹•é—œé–‰
                        return;
                    }
                    videoPlaylist.textContent = `æ­£åœ¨æ’­æ”¾ç¥ç¦ ${index + 1} / ${videoSources.length}`;
                    blessingsVideo.src = videoSources[index];
                    blessingsVideo.play().catch(e => {
                        console.error("å½±ç‰‡æ’­æ”¾å¤±æ•—:", e);
                        videoPlaylist.textContent = `å½±ç‰‡ ${index + 1} è¼‰å…¥å¤±æ•—ï¼Œè«‹æª¢æŸ¥è·¯å¾‘ã€‚`;
                    });
                }
                
                // ç§»é™¤èˆŠçš„ç›£è½å™¨ï¼Œé¿å…é‡è¤‡ç¶å®š
                const playNextVideo = () => {
                    currentVideoIndex++;
                    playVideo(currentVideoIndex);
                };
                blessingsVideo.removeEventListener('ended', playNextVideo); 
                blessingsVideo.addEventListener('ended', playNextVideo);

                playVideo(currentVideoIndex);
            }
            
            // (æ–°å¢çš„) é—œé–‰ç¥ç¦å½±ç‰‡çš„å‡½å¼
            function closeBlessings() {
                blessingsVideo.pause(); // æš«åœå½±ç‰‡
                blessingsVideo.src = ""; // æ¸…ç©ºä¾†æºï¼Œé¿å…èƒŒæ™¯æ’­æ”¾
                blessingsContainer.style.display = 'none';
            }
            
            closeBlessingsButton.addEventListener('click', closeBlessings);

            // --- ç…™ç«ç‰¹æ•ˆé‚è¼¯ ---
            const ctx = canvas.getContext('2d');
            let fireworks = [];
            let particles = [];
            let animationFrameId = null;
            
            // Tone.js éŸ³æ•ˆ (å¯é¸)
            let synth, noiseSynth;
            const setupAudio = () => {
                if (typeof Tone !== 'undefined' && !synth) {
                    synth = new Tone.MembraneSynth().toDestination();
                    noiseSynth = new Tone.NoiseSynth({ envelope: { attack: 0.005, decay: 0.2, sustain: 0 } }).toDestination();
                }
            };
            const playLaunchSound = () => noiseSynth?.triggerAttackRelease("4n");
            const playExplodeSound = () => synth?.triggerAttackRelease("C2", "2n");

            function launchFireworks() {
                if (animationFrameId) {
                    cancelAnimationFrame(animationFrameId);
                }
                
                if (typeof Tone !== 'undefined') {
                    Tone.start().then(setupAudio);
                }

                fireworks = [];
                particles = [];
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
                
                birthdayTitle.style.opacity = 1;
                personalMessage.style.opacity = 0;
                fireworksContainer.classList.remove('hidden');

                fireworks.push(new Firework(true)); 

                setTimeout(() => {
                    for(let i = 0; i < 10; i++) { 
                        setTimeout(() => {
                            const randomX = Math.random() * canvas.width;
                            const randomY = Math.random() * (canvas.height / 2);
                            createExplosion(randomX, randomY, 120, false);
                        }, i * 250);
                    }
                }, 1000);

                setTimeout(() => {
                    birthdayTitle.style.opacity = 0;
                    setTimeout(() => {
                        personalMessage.style.opacity = 1;

                        // (ä¿®æ”¹çš„) ç­‰å¾…ç¥ç¦èªå¥é¡¯ç¤ºå¾Œï¼Œè‡ªå‹•è½‰æ›åˆ°å½±ç‰‡
                        setTimeout(() => {
                            fireworksContainer.classList.add('hidden');
                            if (animationFrameId) {
                                window.cancelAnimationFrame(animationFrameId);
                                animationFrameId = null;
                            }
                            showBlessings(); // å‘¼å«æ’­æ”¾ç¥ç¦å½±ç‰‡çš„å‡½å¼
                        }, 4000); // è¨Šæ¯å‡ºç¾å¾Œç­‰å¾… 4 ç§’

                    }, 1500);
                }, 3500);

                loop();
            }

            function loop() {
                ctx.globalCompositeOperation = 'destination-out';
                ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.globalCompositeOperation = 'lighter';

                for (let i = fireworks.length - 1; i >= 0; i--) {
                    fireworks[i].draw();
                    if (fireworks[i].update()) {
                        fireworks.splice(i, 1);
                    }
                }
                for (let i = particles.length - 1; i >= 0; i--) {
                    particles[i].draw();
                    if (particles[i].update()) {
                        particles.splice(i, 1);
                    }
                }
                animationFrameId = requestAnimationFrame(loop);
            }

            function createExplosion(x, y, count, isGrand) {
                const hue = Math.random() * 360;
                for (let i = 0; i < count; i++) {
                    particles.push(new Particle(x, y, hue, isGrand));
                }
                playExplodeSound();
            }

            class Particle {
                constructor(x, y, hue, isGrand) {
                    this.x = x;
                    this.y = y;
                    this.hue = hue;
                    this.angle = Math.random() * Math.PI * 2;
                    this.speed = Math.random() * (isGrand ? 18 : 10) + 2;
                    this.friction = 0.96;
                    this.gravity = 1;
                    this.alpha = 1;
                    this.decay = Math.random() * 0.03 + 0.01;
                    this.velX = Math.cos(this.angle) * this.speed;
                    this.velY = Math.sin(this.angle) * this.speed;
                }
                update() {
                    this.velX *= this.friction;
                    this.velY *= this.friction;
                    this.velY += this.gravity;
                    this.x += this.velX;
                    this.y += this.velY;
                    this.alpha -= this.decay;
                    return this.alpha <= this.decay;
                }
                draw() {
                    ctx.globalAlpha = this.alpha;
                    ctx.fillStyle = `hsl(${this.hue}, 100%, 50%)`;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.globalAlpha = 1;
                }
            }
            
            class Firework {
                constructor(isGrand = false) {
                    this.isGrand = isGrand;
                    this.x = isGrand ? canvas.width / 2 : Math.random() * canvas.width;
                    this.y = canvas.height;
                    this.targetY = isGrand ? canvas.height / 4 : Math.random() * (canvas.height / 2);
                    this.hue = Math.random() * 360;
                    this.velY = -(Math.random() * 4 + (isGrand ? 12 : 8));
                    this.velX = isGrand ? 0 : (Math.random() - 0.5) * 6;
                    this.particleCount = isGrand ? 400 : 120;
                    playLaunchSound();
                }
                update() {
                    this.x += this.velX;
                    this.y += this.velY;
                    this.velY += 0.2;

                    if (this.y <= this.targetY) {
                        this.explode();
                        return true;
                    }
                    return false;
                }
                explode() {
                    createExplosion(this.x, this.y, this.particleCount, this.isGrand);
                }
                draw() {
                    ctx.fillStyle = `hsl(${this.hue}, 100%, 50%)`;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.isGrand ? 4 : 3, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
        });
    </script>
</body>
</html>
